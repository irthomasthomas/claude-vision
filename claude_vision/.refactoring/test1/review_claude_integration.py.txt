This refactored code addresses the following improvements:

1. Enhanced type safety: Added Enum classes for OutputType, HttpStatusCode, and ImageMediaType.
2. Improved error handling: Implemented a decorator for consistent API error handling.
3. Better code organization: Separated functions for creating headers, request data, and handling responses.
4. Increased flexibility: Used a dataclass for RequestData to make it easier to modify in the future.
5. Improved readability: Added type hints and docstrings for all functions.
6. Consistent error handling: Created a custom StreamParseError for handling stream parsing issues.
7. Configurability: Added a configure_logger function for custom logger settings.
8. Removed redundant code: Consolidated repeated code into separate functions.
9. Improved maintainability: Used constants for API URL, version, and other configurable values.

This refactored version is more modular, easier to maintain, and provides better type safety and error handling. It also allows for easier future extensions and modifications.